#!/bin/bash
export UUID=${UUID:-'fc44fe6a-f083-4591-9c03-f8d61dc3907f'}
export ARGO_DOMAIN=${ARGO_DOMAIN:-'codesandbox.201361.xyz'}          # 固定隧道域名，留空即启用临时隧道
export ARGO_AUTH=${ARGO_AUTH:-'eyJhIjoiODVhOGVmOTM0NjY5NDAyYjgwYzljNDk0NTA5Mjg4YWUiLCJ0IjoiYzQwNDY1ZDctZmVmZS00M2Y4LTg1MTYtZDUzZjczYTU1OWI2IiwicyI6Ik1XWmhZalU1TVRNdE9UbGxNUzAwWW1WakxXRTFORGN0WVRBMVptWTNOR1V5TWpNeiJ9'}             # 固定隧道json或token，留空即启用临时隧道
export CFIP=${CFIP:-'www.epicgames.com'}         # 优选域名或优选ip
export CFPORT=${CFPORT:-'443'}               # 优选域名或优选ip对应端口
export NAME=${NAME:-'Vls'}                 # 节点名称
export FILE_PATH=${FILE_PATH:-'./world'}        # 节点存放文件夹
export ARGO_PORT=${ARGO_PORT:-'8001'}          # Argo端口,使用固定隧道token需在cf后台设置的端口和这里一致

echo "WyAhIC1kICIke0ZJTEVfUEFUSH0iIF0gJiYgbWtkaXIgJHtGSUxFX1BBVEh9CgpybSAtcmYgJHtGSUxFX1BBVEh9L2Jvb3QubG9nICR7RklMRV9QQVRIfS9zdWIudHh0ICR7RklMRV9QQVRIfS9jb25maWcuanNvbiAke0ZJTEVfUEFUSH0vdHVubmVsLmpzb24gJHtGSUxFX1BBVEh9L3R1bm5lbC55bWwgPi9kZXYvbnVsbCAyPiYxCgphcmdvX2NvbmZpZ3VyZSgpIHsKICBpZiBbWyAteiAkQVJHT19BVVRIIHx8IC16ICRBUkdPX0RPTUFJTiBdXTsgdGhlbgogICAgZWNobyAtZSAiXGVbMTszMm1BUkdPX0RPTUFJTiBvciBBUkdPX0FVVEggdmFyaWFibGUgaXMgZW1wdHksIHVzZSBxdWljayB0dW5uZWxzXGVbMG0iCiAgICByZXR1cm4KICBmaQoKICBpZiBbWyAkQVJHT19BVVRIID1+IFR1bm5lbFNlY3JldCBdXTsgdGhlbgogICAgZWNobyAkQVJHT19BVVRIID4gJHtGSUxFX1BBVEh9L3R1bm5lbC5qc29uCiAgICBjYXQgPiAke0ZJTEVfUEFUSH0vdHVubmVsLnltbCA8PCBFT0YKdHVubmVsOiAkKGN1dCAtZFwiIC1mMTIgPDw8ICIkQVJHT19BVVRIIikKY3JlZGVudGlhbHMtZmlsZTogJHtGSUxFX1BBVEh9L3R1bm5lbC5qc29uCnByb3RvY29sOiBodHRwMgoKaW5ncmVzczoKICAtIGhvc3RuYW1lOiAkQVJHT19ET01BSU4KICAgIHNlcnZpY2U6IGh0dHA6Ly9sb2NhbGhvc3Q6JEFSR09fUE9SVAogICAgb3JpZ2luUmVxdWVzdDoKICAgICAgbm9UTFNWZXJpZnk6IHRydWUKICAtIHNlcnZpY2U6IGh0dHBfc3RhdHVzOjQwNApFT0YKICBlbHNlCiAgICBlY2hvIC1lICJcZVsxOzMybUFSR09fQVVUSCBtaXNtYXRjaCBUdW5uZWxTZWNyZXQsdXNlIHRva2VuIGNvbm5lY3QgdG8gdHVubmVsXGVbMG0iCiAgZmkKfQphcmdvX2NvbmZpZ3VyZQp3YWl0CgpnZW5lcmF0ZV9jb25maWcoKSB7CiAgY2F0ID4gJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uIDw8IEVPRgp7CiAgImxvZyI6IHsgImFjY2VzcyI6ICIvZGV2L251bGwiLCAiZXJyb3IiOiAiL2Rldi9udWxsIiwgImxvZ2xldmVsIjogIm5vbmUiIH0sCiAgImluYm91bmRzIjogWwogICAgewogICAgICAicG9ydCI6ICRBUkdPX1BPUlQsCiAgICAgICJwcm90b2NvbCI6ICJ2bGVzcyIsCiAgICAgICJzZXR0aW5ncyI6IHsKICAgICAgICAiY2xpZW50cyI6IFt7ICJpZCI6ICIke1VVSUR9IiwgImZsb3ciOiAieHRscy1ycHJ4LXZpc2lvbiIgfV0sCiAgICAgICAgImRlY3J5cHRpb24iOiAibm9uZSIsCiAgICAgICAgImZhbGxiYWNrcyI6IFsKICAgICAgICAgIHsgImRlc3QiOiAzMDAxIH0sIHsgInBhdGgiOiAiL3ZsZXNzLWFyZ28iLCAiZGVzdCI6IDMwMDIgfSwKICAgICAgICAgIHsgInBhdGgiOiAiL3ZtZXNzLWFyZ28iLCAiZGVzdCI6IDMwMDMgfSwgeyAicGF0aCI6ICIvdHJvamFuLWFyZ28iLCAiZGVzdCI6IDMwMDQgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgInN0cmVhbVNldHRpbmdzIjogeyAibmV0d29yayI6ICJ0Y3AiIH0KICAgIH0sCiAgICB7CiAgICAgICJwb3J0IjogMzAwMSwgImxpc3RlbiI6ICIxMjcuMC4wLjEiLCAicHJvdG9jb2wiOiAidmxlc3MiLAogICAgICAic2V0dGluZ3MiOiB7ICJjbGllbnRzIjogW3sgImlkIjogIiR7VVVJRH0iIH1dLCAiZGVjcnlwdGlvbiI6ICJub25lIiB9LAogICAgICAic3RyZWFtU2V0dGluZ3MiOiB7ICJuZXR3b3JrIjogIndzIiwgInNlY3VyaXR5IjogIm5vbmUiIH0KICAgIH0sCiAgICB7CiAgICAgICJwb3J0IjogMzAwMiwgImxpc3RlbiI6ICIxMjcuMC4wLjEiLCAicHJvdG9jb2wiOiAidmxlc3MiLAogICAgICAic2V0dGluZ3MiOiB7ICJjbGllbnRzIjogW3sgImlkIjogIiR7VVVJRH0iLCAibGV2ZWwiOiAwIH1dLCAiZGVjcnlwdGlvbiI6ICJub25lIiB9LAogICAgICAic3RyZWFtU2V0dGluZ3MiOiB7ICJuZXR3b3JrIjogIndzIiwgInNlY3VyaXR5IjogIm5vbmUiLCAid3NTZXR0aW5ncyI6IHsgInBhdGgiOiAiL3ZsZXNzLWFyZ28iIH0gfSwKICAgICAgInNuaWZmaW5nIjogeyAiZW5hYmxlZCI6IHRydWUsICJkZXN0T3ZlcnJpZGUiOiBbImh0dHAiLCAidGxzIiwgInF1aWMiXSwgIm1ldGFkYXRhT25seSI6IGZhbHNlIH0KICAgIH0sCiAgICB7CiAgICAgICJwb3J0IjogMzAwMywgImxpc3RlbiI6ICIxMjcuMC4wLjEiLCAicHJvdG9jb2wiOiAidm1lc3MiLAogICAgICAic2V0dGluZ3MiOiB7ICJjbGllbnRzIjogW3sgImlkIjogIiR7VVVJRH0iLCAiYWx0ZXJJZCI6IDAgfV0gfSwKICAgICAgInN0cmVhbVNldHRpbmdzIjogeyAibmV0d29yayI6ICJ3cyIsICJ3c1NldHRpbmdzIjogeyAicGF0aCI6ICIvdm1lc3MtYXJnbyIgfSB9LAogICAgICAic25pZmZpbmciOiB7ICJlbmFibGVkIjogdHJ1ZSwgImRlc3RPdmVycmlkZSI6IFsiaHR0cCIsICJ0bHMiLCAicXVpYyJdLCAibWV0YWRhdGFPbmx5IjogZmFsc2UgfQogICAgfQogIF0sCiAgImRucyI6IHsgInNlcnZlcnMiOiBbImh0dHBzK2xvY2FsOi8vOC44LjguOC9kbnMtcXVlcnkiXSB9LAogICJvdXRib3VuZHMiOiBbIHsicHJvdG9jb2wiOiAiZnJlZWRvbSIsICJ0YWciOiAiZGlyZWN0IiB9LHsicHJvdG9jb2wiOiAiYmxhY2tob2xlIiwidGFnIjogImJsb2NrIiB9IF0KfQpFT0YKfQpnZW5lcmF0ZV9jb25maWcKd2FpdAoKQVJDSD0kKHVuYW1lIC1tKSAmJiBET1dOTE9BRF9ESVI9IiR7RklMRV9QQVRIfSIgJiYgbWtkaXIgLXAgIiRET1dOTE9BRF9ESVIiICYmIEZJTEVfSU5GTz0oKQppZiBbICIkQVJDSCIgPT0gImFybSIgXSB8fCBbICIkQVJDSCIgPT0gImFybTY0IiBdIHx8IFsgIiRBUkNIIiA9PSAiYWFyY2g2NCIgXTsgdGhlbgogICAgRklMRV9JTkZPPSgiaHR0cHM6Ly9naXRodWIuY29tL2Vvb2NlL3Rlc3QvcmVsZWFzZXMvZG93bmxvYWQvYXJtNjQvYm90MTMgYm90IiAiaHR0cHM6Ly9naXRodWIuY29tL2Vvb2NlL3Rlc3QvcmVsZWFzZXMvZG93bmxvYWQvQVJNL3dlYiB3ZWIiKQplbGlmIFsgIiRBUkNIIiA9PSAiYW1kNjQiIF0gfHwgWyAiJEFSQ0giID09ICJ4ODZfNjQiIF0gfHwgWyAiJEFSQ0giID09ICJ4ODYiIF07IHRoZW4KICAgIEZJTEVfSU5GTz0oImh0dHBzOi8vZ2l0aHViLmNvbS9lb29jZS90ZXN0L3JlbGVhc2VzL2Rvd25sb2FkL2FtZDY0L2JvdCBib3QiICJodHRwczovL2dpdGh1Yi5jb20vZW9vY2UvdGVzdC9yZWxlYXNlcy9kb3dubG9hZC8xMjMvd2ViIHdlYiIpCmVsc2UKICAgIGVjaG8gIlVuc3VwcG9ydGVkIGFyY2hpdGVjdHVyZTogJEFSQ0giCiAgICBleGl0IDEKZmkKZm9yIGVudHJ5IGluICIke0ZJTEVfSU5GT1tAXX0iOyBkbwogICAgVVJMPSQoZWNobyAiJGVudHJ5IiB8IGN1dCAtZCAnICcgLWYgMSkKICAgIE5FV19GSUxFTkFNRT0kKGVjaG8gIiRlbnRyeSIgfCBjdXQgLWQgJyAnIC1mIDIpCiAgICBGSUxFTkFNRT0iJERPV05MT0FEX0RJUi8kTkVXX0ZJTEVOQU1FIgogICAgaWYgWyAtZSAiJEZJTEVOQU1FIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiXGVbMTszMm0kRklMRU5BTUUgYWxyZWFkeSBleGlzdHMsU2tpcHBpbmcgZG93bmxvYWRcZVswbSIKICAgIGVsc2UKICAgICAgICBjdXJsIC1MIC1zUyAtbyAiJEZJTEVOQU1FIiAiJFVSTCIKICAgICAgICBlY2hvIC1lICJcZVsxOzMybURvd25sb2FkaW5nICRGSUxFTkFNRVxlWzBtIgogICAgZmkKZG9uZQp3YWl0CgpydW4oKSB7CiAgaWYgWyAtZSAiJHtGSUxFX1BBVEh9L3dlYiIgXTsgdGhlbgogICAgY2htb2QgNzc3ICIke0ZJTEVfUEFUSH0vd2ViIgogICAgbm9odXAgJHtGSUxFX1BBVEh9L3dlYiAtYyAke0ZJTEVfUEFUSH0vY29uZmlnLmpzb24gPi9kZXYvbnVsbCAyPiYxICYKCSAgc2xlZXAgMgogICAgcGdyZXAgLXggIndlYiIgPiAvZGV2L251bGwgJiYgZWNobyAtZSAiXGVbMTszMm13ZWIgaXMgcnVubmluZ1xlWzBtIiB8fCB7IGVjaG8gLWUgIlxlWzE7MzVtd2ViIGlzIG5vdCBydW5uaW5nLCByZXN0YXJ0aW5nLi4uXGVbMG0iOyBwa2lsbCAteCAid2ViIiAmJiBub2h1cCAiJHtGSUxFX1BBVEh9L3dlYiIgLWMgJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uID4vZGV2L251bGwgMj4mMSAmIHNsZWVwIDI7IGVjaG8gLWUgIlxlWzE7MzJtd2ViIHJlc3RhcnRlZFxlWzBtIjsgfQogIGZpCgogIGlmIFsgLWUgIiR7RklMRV9QQVRIfS9ib3QiIF07IHRoZW4KICAgIGNobW9kIDc3NyAiJHtGSUxFX1BBVEh9L2JvdCIKICAgIGlmIFtbICRBUkdPX0FVVEggPX4gXltBLVowLTlhLXo9XXsxMjAsMjUwfSQgXV07IHRoZW4KICAgICAgYXJncz0idHVubmVsIC0tZWRnZS1pcC12ZXJzaW9uIGF1dG8gLS1uby1hdXRvdXBkYXRlIC0tcHJvdG9jb2wgaHR0cDIgcnVuIC0tdG9rZW4gJHtBUkdPX0FVVEh9IgogICAgZWxpZiBbWyAkQVJHT19BVVRIID1+IFR1bm5lbFNlY3JldCBdXTsgdGhlbgogICAgICBhcmdzPSJ0dW5uZWwgLS1lZGdlLWlwLXZlcnNpb24gYXV0byAtLWNvbmZpZyAke0ZJTEVfUEFUSH0vdHVubmVsLnltbCBydW4iCiAgICBlbHNlCiAgICAgIGFyZ3M9InR1bm5lbCAtLWVkZ2UtaXAtdmVyc2lvbiBhdXRvIC0tbm8tYXV0b3VwZGF0ZSAtLXByb3RvY29sIGh0dHAyIC0tbG9nZmlsZSAke0ZJTEVfUEFUSH0vYm9vdC5sb2cgLS1sb2dsZXZlbCBpbmZvIC0tdXJsIGh0dHA6Ly9sb2NhbGhvc3Q6JEFSR09fUE9SVCIKICAgIGZpCiAgICBub2h1cCAke0ZJTEVfUEFUSH0vYm90ICRhcmdzID4vZGV2L251bGwgMj4mMSAmCiAgICBzbGVlcCAyCiAgICBwZ3JlcCAteCAiYm90IiA+IC9kZXYvbnVsbCAmJiBlY2hvIC1lICJcZVsxOzMybWJvdCBpcyBydW5uaW5nXGVbMG0iIHx8IHsgZWNobyAtZSAiXGVbMTszNW1ib3QgaXMgbm90IHJ1bm5pbmcsIHJlc3RhcnRpbmcuLi5cZVswbSI7IHBraWxsIC14ICJib3QiICYmIG5vaHVwICIke0ZJTEVfUEFUSH0vYm90IiAkYXJncyA+L2Rldi9udWxsIDI+JjEgJiBzbGVlcCAyOyBlY2hvIC1lICJcZVsxOzMybWJvdCByZXN0YXJ0ZWRcZVswbSI7IH0KICBmaQp9IApydW4Kc2xlZXAgMgoKZ2V0X2FyZ29kb21haW4oKSB7CiAgaWYgW1sgLW4gJEFSR09fQVVUSCBdXTsgdGhlbgogICAgZWNobyAiJEFSR09fRE9NQUlOIgogIGVsc2UKICAgIGxvY2FsIHJldHJ5PTAKICAgIGxvY2FsIG1heF9yZXRyaWVzPTYKICAgIGxvY2FsIGFyZ29kb21haW49IiIKICAgIHdoaWxlIFtbICRyZXRyeSAtbHQgJG1heF9yZXRyaWVzIF1dOyBkbwogICAgICAoKHJldHJ5KyspKQogICAgICBhcmdvZG9tYWluPSQoc2VkIC1uICdzfC4qaHR0cHM6Ly9cKFteL10qdHJ5Y2xvdWRmbGFyZVwuY29tXCkuKnxcMXxwJyAiJHtGSUxFX1BBVEh9L2Jvb3QubG9nIikgCiAgICAgIGlmIFtbIC1uICRhcmdvZG9tYWluIF1dOyB0aGVuCiAgICAgICAgYnJlYWsKICAgICAgZmkKICAgICAgc2xlZXAgMQogICAgZG9uZQogICAgZWNobyAiJGFyZ29kb21haW4iCiAgZmkKfQoKZ2VuZXJhdGVfbGlua3MoKSB7CiAgYXJnb2RvbWFpbj0kKGdldF9hcmdvZG9tYWluKQogIGVjaG8gLWUgIlxlWzE7MzJtQXJnb0RvbWFpbjpcZVsxOzM1bSR7YXJnb2RvbWFpbn1cZVswbSIKICBzbGVlcCAyCgogIGlzcD0kKGN1cmwgLXMgaHR0cHM6Ly9zcGVlZC5jbG91ZGZsYXJlLmNvbS9tZXRhIHwgYXdrIC1GXCIgJ3twcmludCAkMjYiLSIkMTh9JyB8IHNlZCAtZSAncy8gL18vZycpCiAgc2xlZXAgMgoKICBWTUVTUz0ieyBcInZcIjogXCIyXCIsIFwicHNcIjogXCIke05BTUV9LSR7aXNwfVwiLCBcImFkZFwiOiBcIiR7Q0ZJUH1cIiwgXCJwb3J0XCI6IFwiJHtDRlBPUlR9XCIsIFwiaWRcIjogXCIke1VVSUR9XCIsIFwiYWlkXCI6IFwiMFwiLCBcInNjeVwiOiBcIm5vbmVcIiwgXCJuZXRcIjogXCJ3c1wiLCBcInR5cGVcIjogXCJub25lXCIsIFwiaG9zdFwiOiBcIiR7YXJnb2RvbWFpbn1cIiwgXCJwYXRoXCI6IFwiL3ZtZXNzLWFyZ28/ZWQ9MjA0OFwiLCBcInRsc1wiOiBcInRsc1wiLCBcInNuaVwiOiBcIiR7YXJnb2RvbWFpbn1cIiwgXCJhbHBuXCI6IFwiXCIgfSIKCiAgY2F0ID4gJHtGSUxFX1BBVEh9L2xpc3QudHh0IDw8RU9GCnZsZXNzOi8vJHtVVUlEfUAke0NGSVB9OiR7Q0ZQT1JUfT9lbmNyeXB0aW9uPW5vbmUmc2VjdXJpdHk9dGxzJnNuaT0ke2FyZ29kb21haW59JnR5cGU9d3MmaG9zdD0ke2FyZ29kb21haW59JnBhdGg9JTJGdmxlc3MtYXJnbyUzRmVkJTNEMjA0OCMke05BTUV9LSR7aXNwfQoKdm1lc3M6Ly8kKGVjaG8gIiRWTUVTUyIgfCBiYXNlNjQgLXcwKQoKRU9GCgogIGJhc2U2NCAtdzAgJHtGSUxFX1BBVEh9L2xpc3QudHh0ID4gJHtGSUxFX1BBVEh9L3N1Yi50eHQKICBjYXQgJHtGSUxFX1BBVEh9L3N1Yi50eHQKICBlY2hvIC1lICJcblxlWzE7MzJtJHtGSUxFX1BBVEh9L3N1Yi50eHQgc2F2ZWQgc3VjY2Vzc2Z1bGx5XGVbMG0iCiAgc2xlZXAgNSAgCiMgIHJtIC1yZiAke0ZJTEVfUEFUSH0vbGlzdC50eHQgJHtGSUxFX1BBVEh9L2Jvb3QubG9nICR7RklMRV9QQVRIfS9jb25maWcuanNvbiAke0ZJTEVfUEFUSH0vdHVubmVsLmpzb24gJHtGSUxFX1BBVEh9L3R1bm5lbC55bWwgJHtGSUxFX1BBVEh9L3dlYiAke0ZJTEVfUEFUSH0vYm90Cn0KZ2VuZXJhdGVfbGlua3MKZWNobyAtZSAiXGVbMTs5Nm1SdW5uaW5nIGRvbmUhXGVbMG0iCmVjaG8gLWUgIlxlWzE7OTZtVGhhbmsgeW91IGZvciB1c2luZyB0aGlzIHNjcmlwdCxlbmpveSFcZVswbSIKc2xlZXAgNjAKY2xlYXI" | base64 -d | bash